[{"path":[]},{"path":"https://nancyrzhanglab.github.io/multiomeFate/articles/simulation.html","id":"quick-api-map-what-each-function-does","dir":"Articles","previous_headings":"Overall requirements on running CYFER","what":"Quick API map (what each function does)","title":"Simulation","text":"lineage_cv(...) K-fold CV decreasing λ-sequence produced lineage_imputation_sequence(). fold, trains cell_features[-fold] evaluates unpenalized objective held-cells (train split). Returns list (one per fold) : train_fit: result lineage_imputation_sequence() (contains fit_list, lambda_sequence) train_loglik, test_loglik: vectors λ (lower better; objective value, literal log-likelihood) Optional checkpointing via savefile_tmp. lineage_cv_finalize(cell_features, cell_lineage, fit_res, lineage_future_count) Picks λ minimizing median across folds test_loglik λ. Refits data chosen λ, initializing corresponding coefficients first fold’s path. Returns: cell_imputed_score: per-cell log10(imputed count) (.e., log10(exp(xβ))) coefficient_vec, chosen lambda lineage_imputed_count: sum imputed counts per lineage. lineage_imputation_sequence(...) Computes initial λ via .compute_initial_parameters(), builds decreasing λ-grid value 0, calls lineage_imputation() λ (warm-started). Returns fit_list (best run per λ) lambda_sequence. lineage_imputation(...) Core optimizer. Cleans inputs, ensures Intercept, runs BFGS objective/gradient (.lineage_objective, .lineage_gradient) set provided inits plus several randomized inits. Returns: fit: best solution (minimal objective) coefficient_vec, objective_val, etc. res_list: starts. evaluate_loglikelihood(...) Thin wrapper runs .lineage_objective(...) cleanup. Note: returns objective value (data term averaged lineages, plus penalty lambda>0), conventional log-likelihood.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/articles/simulation.html","id":"data-shape-assumptions-to-check-before-fitting","dir":"Articles","previous_headings":"Overall requirements on running CYFER","what":"Data & shape assumptions (to check before fitting)","title":"Simulation","text":"cell_features: numeric matrix, rownames = cell IDs, colnames = feature names, NAs. “Intercept” column, ’s added internally needed. cell_lineage: factor/character vector length nrow(cell_features), giving cell’s lineage label. lineage_future_count: named numeric vector; names lineage IDs. code intersects names(lineage_future_count) observed lineages silently drops cells/lineages aren’t shared. tab_mat, future_timepoint: numeric 2-column matrix rows named lineage (appeared ). two columns, one number cells current timepoint (corresponding ). number cells future timepoint (corresponding ).","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/articles/simulation.html","id":"objective-optimized-brief-math","dir":"Articles","previous_headings":"Overall requirements on running CYFER","what":"Objective optimized (brief math)","title":"Simulation","text":"Let β coefficients (ridge penalty excludes intercept). Define per-cell number predicted progenies cell \\(\\) lineage \\(\\ell\\) \\(s_i=\\exp(x_i^\\top \\beta)\\). Let \\(L\\) set lineages \\(Y_\\ell\\) future count lineage \\(\\ell\\). objective minimized \\[ \\frac{1}{|L|}\\Big(\\sum_i s_i \\;-\\; \\sum_{\\ell\\L} Y_\\ell \\log \\sum_{\\\\ell} s_i\\Big)\\;+\\;\\lambda\\,\\|\\beta_{\\setminus \\text{Intercept}}\\|_2^2, \\] analytic gradient implemented .lineage_gradient(). CV note: Validation compares unpenalized objectives held-cells (penalty set 0 evaluation) assess generalization data term.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/articles/simulation.html","id":"priming-simulation","dir":"Articles","previous_headings":"","what":"Priming simulation","title":"Simulation","text":"","code":"library(multiomeFate) data(\"priming_simulation\", package = \"multiomeFate\") priming_simulation$cell_features[1:5,1:5] #>        fastTopicCOCL2_1 fastTopicCOCL2_2 fastTopicCOCL2_3 fastTopicCOCL2_4 #> cell:1       -0.8179598       0.02240982       -0.1106094      -0.66861435 #> cell:2        1.0155892      -0.31934930       -0.3443518      -0.58763318 #> cell:3        1.0573658      -0.32589331       -0.3443518       0.27433725 #> cell:4        1.7019937      -0.27025714       -0.1094102      -0.22460944 #> cell:5       -0.1769124      -0.32589331        1.0865580       0.09678745 #>        fastTopicCOCL2_5 #> cell:1      -0.30615968 #> cell:2      -0.45021257 #> cell:3      -0.45021257 #> cell:4      -0.03842152 #> cell:5       2.57059409 head(priming_simulation$cell_lineage) #> [1] \"lineage:33\" \"lineage:1\"  \"lineage:15\" \"lineage:15\" \"lineage:37\" #> [6] \"lineage:37\" head(priming_simulation$lineage_future_count) #>  lineage:1  lineage:4  lineage:7 lineage:15 lineage:12 lineage:14  #>        342        178        169        144        136        126 head(priming_simulation$tab_mat) #>            now future #> lineage:1  221    342 #> lineage:4  154    178 #> lineage:7  162    169 #> lineage:15 169    144 #> lineage:12 149    136 #> lineage:14 144    126 set.seed(10) fit_res <- multiomeFate:::lineage_cv(   cell_features = priming_simulation$cell_features,   cell_lineage = priming_simulation$cell_lineage,   future_timepoint = \"future\",   lineage_future_count = priming_simulation$lineage_future_count,   lambda_initial = 3,   lambda_sequence_length = 10,   tab_mat = priming_simulation$tab_mat,   num_folds = 2,   verbose = 2 ) #> [1] \"Dropping fold #1 out of 2\" #> [1] \"Dropping fold #2 out of 2\" final_fit <- multiomeFate:::lineage_cv_finalize(   cell_features = priming_simulation$cell_features,   cell_lineage = priming_simulation$cell_lineage,   fit_res = fit_res,   lineage_future_count = priming_simulation$lineage_future_count ) names(final_fit) #> [1] \"cell_imputed_score\"    \"coefficient_vec\"       \"lambda\"                #> [4] \"lineage_imputed_count\" cell_imputed_score <- as.numeric(priming_simulation$cell_features %*% final_fit$coefficient_vec[-1]) + final_fit$coefficient_vec[1] cell_imputed_score <- log10(exp(cell_imputed_score)) names(cell_imputed_score) <- rownames(priming_simulation$cell_features)  assigned_lineage <- priming_simulation$cell_lineage names(assigned_lineage) <- rownames(priming_simulation$cell_features)  lineage_vec <- assigned_lineage[names(cell_imputed_score)] tab_vec <- table(assigned_lineage)  lineage_sizes <- final_fit$lineage_imputed_count lineage_names <- names(lineage_sizes)[order(lineage_sizes, decreasing = TRUE)]   # form data frame df <- data.frame(lineage = factor(lineage_vec, levels = lineage_names),                  imputed_count = cell_imputed_score)  col_vec <- rep(\"lightgray\", length(lineage_names)) names(col_vec) <- lineage_names  plot1 <- ggplot2::ggplot(df, ggplot2::aes(x=lineage, y=imputed_count)) plot1 <- plot1 + ggplot2::geom_violin(trim=TRUE, scale = \"width\", ggplot2::aes(fill=lineage)) plot1 <- plot1 + ggplot2::scale_fill_manual(values = col_vec)  plot1 <- plot1 + ggplot2::geom_jitter(shape=16, position=ggplot2::position_jitter(0.2), alpha = 0.1, size = 0.5) plot1 <- plot1 + Seurat::NoLegend() plot1 <- plot1 + ggplot2::scale_x_discrete(limits = lineage_names,                                            guide = ggplot2::guide_axis(angle = 45)) plot1 <- plot1 + ggplot2::stat_summary(fun = median, geom = \"crossbar\",                                         width = 0.75, color = \"#633895\")  plot1"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/articles/simulation.html","id":"plastic-simulation","dir":"Articles","previous_headings":"","what":"Plastic simulation","title":"Simulation","text":"","code":"data(\"plastic_simulation\") set.seed(10) fit_res <- multiomeFate:::lineage_cv(   cell_features = plastic_simulation$cell_features,   cell_lineage = plastic_simulation$cell_lineage,   future_timepoint = \"future\",   lineage_future_count = plastic_simulation$lineage_future_count,   lambda_initial = 3,   lambda_sequence_length = 10,   tab_mat = plastic_simulation$tab_mat,   num_folds = 2,   verbose = 2 ) #> [1] \"Dropping fold #1 out of 2\" #> [1] \"Dropping fold #2 out of 2\"  final_fit <- multiomeFate:::lineage_cv_finalize(   cell_features = plastic_simulation$cell_features,   cell_lineage = plastic_simulation$cell_lineage,   fit_res = fit_res,   lineage_future_count = plastic_simulation$lineage_future_count ) cell_imputed_score <- as.numeric(plastic_simulation$cell_features %*% final_fit$coefficient_vec[-1]) + final_fit$coefficient_vec[1] cell_imputed_score <- log10(exp(cell_imputed_score)) names(cell_imputed_score) <- rownames(plastic_simulation$cell_features)  assigned_lineage <- plastic_simulation$cell_lineage names(assigned_lineage) <- rownames(plastic_simulation$cell_features)  lineage_vec <- assigned_lineage[names(cell_imputed_score)] tab_vec <- table(assigned_lineage)  lineage_sizes <- final_fit$lineage_imputed_count lineage_names <- names(lineage_sizes)[order(lineage_sizes, decreasing = TRUE)]   # form data frame df <- data.frame(lineage = factor(lineage_vec, levels = lineage_names),                  imputed_count = cell_imputed_score)  col_vec <- rep(\"lightgray\", length(lineage_names)) names(col_vec) <- lineage_names  plot1 <- ggplot2::ggplot(df, ggplot2::aes(x=lineage, y=imputed_count)) plot1 <- plot1 + ggplot2::geom_violin(trim=TRUE, scale = \"width\", ggplot2::aes(fill=lineage)) plot1 <- plot1 + ggplot2::scale_fill_manual(values = col_vec)  plot1 <- plot1 + ggplot2::geom_jitter(shape=16, position=ggplot2::position_jitter(0.2), alpha = 0.1, size = 0.5) plot1 <- plot1 + Seurat::NoLegend() plot1 <- plot1 + ggplot2::scale_x_discrete(limits = lineage_names,                                            guide = ggplot2::guide_axis(angle = 45)) plot1 <- plot1 + ggplot2::stat_summary(fun = median, geom = \"crossbar\",                                         width = 0.75, color = \"#0D8242\")  plot1"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kevin Lin. Author, maintainer. Xinyi Chen. Author.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lin K, Chen X (2025). multiomeFate: CYFER, modeling number progenies cancer cells. R package version 1.0.0.001, https://nancyrzhanglab.github.io/multiomeFate/.","code":"@Manual{,   title = {multiomeFate: CYFER, for modeling the number of progenies of cancer cells},   author = {Kevin Lin and Xinyi Chen},   year = {2025},   note = {R package version 1.0.0.001},   url = {https://nancyrzhanglab.github.io/multiomeFate/}, }"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/index.html","id":"purpose","dir":"","previous_headings":"","what":"CYFER, for modeling the number of progenies of cancer cells","title":"CYFER, for modeling the number of progenies of cancer cells","text":"repository contains functions perform CYFER downstream analysis, paper “Temporal Clonal Resolution Cellular Evolution Stress”. See companion GitHub package https://github.com/nancyrzhanglab/multiomeFate_analysis analyses performed paper. code developed tested primarily R 4.3.2. Macbook (macOS Sonoma 14.2.1) equipped i7 processor.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"CYFER, for modeling the number of progenies of cancer cells","text":"package can installed devtools R. package depends several packages. include Seurat, cowplot, ggplot2, ggrepel, ggtern, scCustomize, plyr. See last section README see (.e., CRAN, Bioconductor, GitHub) download packages. installation dependencies, installation multiomeFate package fast (less 2 minutes).","code":"library(\"devtools\") devtools::install_github(\"nancyrzhanglab/multiomeFate\") > devtools::session_info() ─ Session info ───────────────────  setting  value  version  R version 4.3.2 (2023-10-31)  os       macOS Sonoma 14.2.1  system   aarch64, darwin20  ui       RStudio  language (EN)  collate  en_US.UTF-8  ctype    en_US.UTF-8  tz       America/Los_Angeles  date     2025-06-11  rstudio  2024.12.0+467 Kousa Dogwood (desktop)  pandoc   NA  quarto   1.5.57 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/quarto  ─ Packages ───────────────────────  !  package          * version    date (UTC) lib source     abind              1.4-8      2024-09-12 [1] CRAN (R 4.3.3)     bayesm             3.1-6      2023-09-23 [1] CRAN (R 4.3.1)     beeswarm           0.4.0      2021-06-01 [1] CRAN (R 4.3.0)     brio               1.1.5      2024-04-24 [1] CRAN (R 4.3.1)     cachem             1.1.0      2024-05-16 [1] CRAN (R 4.3.3)     circlize           0.4.16     2024-02-20 [1] CRAN (R 4.3.3)     cli                3.6.5      2025-04-23 [1] CRAN (R 4.3.3)     cluster            2.1.8.1    2025-03-12 [1] CRAN (R 4.3.3)     codetools          0.2-20     2024-03-31 [1] CRAN (R 4.3.1)     colorspace         2.1-1      2024-07-26 [1] CRAN (R 4.3.3)     compositions       2.0-8      2024-01-31 [1] CRAN (R 4.3.1)     cowplot            1.1.3      2024-01-22 [1] CRAN (R 4.3.1)     data.table         1.17.4     2025-05-26 [1] CRAN (R 4.3.3)     deldir             2.0-4      2024-02-28 [1] CRAN (R 4.3.1)     DEoptimR           1.1-3-1    2024-11-23 [1] CRAN (R 4.3.3)     desc               1.4.3      2023-12-10 [1] CRAN (R 4.3.1)     devtools         * 2.4.5      2022-10-11 [1] CRAN (R 4.3.0)     dichromat          2.0-0.1    2022-05-02 [1] CRAN (R 4.3.3)     digest             0.6.37     2024-08-19 [1] CRAN (R 4.3.3)     dotCall64          1.2        2024-10-04 [1] CRAN (R 4.3.3)     dplyr              1.1.4      2023-11-17 [1] CRAN (R 4.3.1)     ellipsis           0.3.2      2021-04-29 [1] CRAN (R 4.3.0)     farver             2.1.2      2024-05-13 [1] CRAN (R 4.3.3)     fastDummies        1.7.5      2025-01-20 [1] CRAN (R 4.3.3)     fastmap            1.2.0      2024-05-15 [1] CRAN (R 4.3.3)     fitdistrplus       1.2-2      2025-01-07 [1] CRAN (R 4.3.3)     forcats            1.0.0      2023-01-29 [1] CRAN (R 4.3.0)     fs                 1.6.6      2025-04-12 [1] CRAN (R 4.3.3)     future             1.40.0     2025-04-10 [1] CRAN (R 4.3.3)     future.apply       1.11.3     2024-10-27 [1] CRAN (R 4.3.3)     generics           0.1.4      2025-05-09 [1] CRAN (R 4.3.3)     ggbeeswarm         0.7.2      2023-04-29 [1] CRAN (R 4.3.0)     ggplot2            3.5.2      2025-04-09 [1] CRAN (R 4.3.3)     ggprism            1.0.6      2025-05-17 [1] CRAN (R 4.3.3)     ggrastr            1.0.2      2023-06-01 [1] CRAN (R 4.3.0)     ggrepel            0.9.6      2024-09-07 [1] CRAN (R 4.3.3)     ggridges           0.5.6      2024-01-23 [1] CRAN (R 4.3.1)     ggtern             3.5.0      2024-03-24 [1] CRAN (R 4.3.1)     GlobalOptions      0.1.2      2020-06-10 [1] CRAN (R 4.3.0)     globals            0.17.0     2025-04-16 [1] CRAN (R 4.3.3)     glue               1.8.0      2024-09-30 [1] CRAN (R 4.3.3)     goftest            1.2-3      2021-10-07 [1] CRAN (R 4.3.0)     gridExtra          2.3        2017-09-09 [1] CRAN (R 4.3.0)     gtable             0.3.6      2024-10-25 [1] CRAN (R 4.3.3)     hexbin             1.28.5     2024-11-13 [1] CRAN (R 4.3.3)     htmltools          0.5.8.1    2024-04-04 [1] CRAN (R 4.3.2)     htmlwidgets        1.6.4      2023-12-06 [1] CRAN (R 4.3.1)     httpuv             1.6.16     2025-04-16 [1] CRAN (R 4.3.3)     httr               1.4.7      2023-08-15 [1] CRAN (R 4.3.0)     ica                1.0-3      2022-07-08 [1] CRAN (R 4.3.0)     igraph             2.1.4      2025-01-23 [1] CRAN (R 4.3.3)     irlba              2.3.5.1    2022-10-03 [1] CRAN (R 4.3.2)     janitor            2.2.1      2024-12-22 [1] CRAN (R 4.3.3)     jsonlite           2.0.0      2025-03-27 [1] CRAN (R 4.3.3)     KernSmooth         2.23-26    2025-01-01 [1] CRAN (R 4.3.3)     later              1.4.2      2025-04-08 [1] CRAN (R 4.3.3)     latex2exp          0.9.6      2022-11-28 [1] CRAN (R 4.3.0)     lattice            0.22-7     2025-04-02 [1] CRAN (R 4.3.3)     lazyeval           0.2.2      2019-03-15 [1] CRAN (R 4.3.0)     lifecycle          1.0.4      2023-11-07 [1] CRAN (R 4.3.1)     listenv            0.9.1      2024-01-29 [1] CRAN (R 4.3.1)     lmtest             0.9-40     2022-03-21 [1] CRAN (R 4.3.0)     lubridate          1.9.4      2024-12-08 [1] CRAN (R 4.3.3)     magrittr           2.0.3      2022-03-30 [1] CRAN (R 4.3.0)     MASS               7.3-60.0.1 2024-01-13 [1] CRAN (R 4.3.1)     Matrix             1.6-5      2024-01-11 [1] CRAN (R 4.3.2)     matrixStats        1.5.0      2025-01-07 [1] CRAN (R 4.3.3)     memoise            2.0.1      2021-11-26 [1] CRAN (R 4.3.0)     mime               0.13       2025-03-17 [1] CRAN (R 4.3.3)     miniUI             0.1.2      2025-04-17 [1] CRAN (R 4.3.3)  VP multiomeFate     * 1.0.0      2025-06-04 [?] load_all() (on disk 0.0.0.100)     nlme               3.1-168    2025-03-31 [1] CRAN (R 4.3.3)     paletteer          1.6.0      2024-01-21 [1] CRAN (R 4.3.1)     parallelly         1.45.0     2025-06-02 [1] CRAN (R 4.3.3)     patchwork          1.3.0      2024-09-16 [1] CRAN (R 4.3.3)     pbapply            1.7-2      2023-06-27 [1] CRAN (R 4.3.0)     pillar             1.10.2     2025-04-05 [1] CRAN (R 4.3.3)     pkgbuild           1.4.8      2025-05-26 [1] CRAN (R 4.3.3)     pkgconfig          2.0.3      2019-09-22 [1] CRAN (R 4.3.0)     pkgload            1.4.0      2024-06-28 [1] CRAN (R 4.3.3)     plotly             4.10.4     2024-01-13 [1] CRAN (R 4.3.1)     plyr               1.8.9      2023-10-02 [1] CRAN (R 4.3.1)     png                0.1-8      2022-11-29 [1] CRAN (R 4.3.0)     polyclip           1.10-7     2024-07-23 [1] CRAN (R 4.3.3)     profvis            0.4.0      2024-09-20 [1] CRAN (R 4.3.3)     progressr          0.15.1     2024-11-22 [1] CRAN (R 4.3.3)     promises           1.3.3      2025-05-29 [1] CRAN (R 4.3.3)     proto              1.0.0      2016-10-29 [1] CRAN (R 4.3.0)     purrr              1.0.4      2025-02-05 [1] CRAN (R 4.3.3)     R6                 2.6.1      2025-02-15 [1] CRAN (R 4.3.3)     RANN               2.6.2      2024-08-25 [1] CRAN (R 4.3.3)     RColorBrewer       1.1-3      2022-04-03 [1] CRAN (R 4.3.0)     Rcpp               1.0.14     2025-01-12 [1] CRAN (R 4.3.3)     RcppAnnoy          0.0.22     2024-01-23 [1] CRAN (R 4.3.1)     RcppHNSW           0.6.0      2024-02-04 [1] CRAN (R 4.3.1)     rematch2           2.1.2      2020-05-01 [1] CRAN (R 4.3.0)     remotes            2.5.0      2024-03-17 [1] CRAN (R 4.3.3)     reshape2           1.4.4      2020-04-09 [1] CRAN (R 4.3.0)     reticulate         1.42.0     2025-03-25 [1] CRAN (R 4.3.3)     rlang              1.1.6      2025-04-11 [1] CRAN (R 4.3.3)     robustbase         0.99-4-1   2024-09-27 [1] CRAN (R 4.3.3)     ROCR               1.0-11     2020-05-02 [1] CRAN (R 4.3.0)     rprojroot          2.0.4      2023-11-05 [1] CRAN (R 4.3.1)     RSpectra           0.16-2     2024-07-18 [1] CRAN (R 4.3.3)     rstudioapi         0.17.1     2024-10-22 [1] CRAN (R 4.3.3)     Rtsne              0.17       2023-12-07 [1] CRAN (R 4.3.1)     scales             1.4.0      2025-04-24 [1] CRAN (R 4.3.3)     scattermore        1.2        2023-06-12 [1] CRAN (R 4.3.0)     scCustomize        3.0.1      2024-12-18 [1] CRAN (R 4.3.3)     sctransform        0.4.2      2025-04-30 [1] CRAN (R 4.3.3)     sessioninfo        1.2.3      2025-02-05 [1] CRAN (R 4.3.3)     Seurat             5.2.1      2025-01-24 [1] CRAN (R 4.3.3)     SeuratObject       5.1.0      2025-04-22 [1] CRAN (R 4.3.3)     shape              1.4.6.1    2024-02-23 [1] CRAN (R 4.3.1)     shiny              1.10.0     2024-12-14 [1] CRAN (R 4.3.3)     snakecase          0.11.1     2023-08-27 [1] CRAN (R 4.3.0)     sp                 2.2-0      2025-02-01 [1] CRAN (R 4.3.3)     spam               2.11-1     2025-01-20 [1] CRAN (R 4.3.3)     spatstat.data      3.1-6      2025-03-17 [1] CRAN (R 4.3.3)     spatstat.explore   3.4-3      2025-05-21 [1] CRAN (R 4.3.3)     spatstat.geom      3.4-1      2025-05-20 [1] CRAN (R 4.3.3)     spatstat.random    3.4-1      2025-05-20 [1] CRAN (R 4.3.3)     spatstat.sparse    3.1-0      2024-06-21 [1] CRAN (R 4.3.3)     spatstat.univar    3.1-3      2025-05-08 [1] CRAN (R 4.3.3)     spatstat.utils     3.1-4      2025-05-15 [1] CRAN (R 4.3.3)     stringi            1.8.7      2025-03-27 [1] CRAN (R 4.3.3)     stringr            1.5.1      2023-11-14 [1] CRAN (R 4.3.1)     survival           3.8-3      2024-12-17 [1] CRAN (R 4.3.3)     tensor             1.5        2012-05-05 [1] CRAN (R 4.3.0)     tensorA            0.36.2.1   2023-12-13 [1] CRAN (R 4.3.1)     testthat         * 3.2.3      2025-01-13 [1] CRAN (R 4.3.3)     tibble             3.3.0      2025-06-08 [1] CRAN (R 4.3.3)     tidyr              1.3.1      2024-01-24 [1] CRAN (R 4.3.1)     tidyselect         1.2.1      2024-03-11 [1] CRAN (R 4.3.1)     timechange         0.3.0      2024-01-18 [1] CRAN (R 4.3.1)     urlchecker         1.0.1      2021-11-30 [1] CRAN (R 4.3.0)     usethis          * 3.1.0      2024-11-26 [1] CRAN (R 4.3.3)     uwot               0.2.3      2025-02-24 [1] CRAN (R 4.3.3)     vctrs              0.6.5      2023-12-01 [1] CRAN (R 4.3.1)     vipor              0.4.7      2023-12-18 [1] CRAN (R 4.3.1)     viridisLite        0.4.2      2023-05-02 [1] CRAN (R 4.3.0)     withr              3.0.2      2024-10-28 [1] CRAN (R 4.3.3)     xtable             1.8-4      2019-04-21 [1] CRAN (R 4.3.0)     zoo                1.8-14     2025-04-10 [1] CRAN (R 4.3.3)   [1] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library   * ── Packages attached to the search path.  V ── Loaded and on-disk version mismatch.  P ── Loaded and on-disk path mismatch.  ──────────────────────────────────"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/data_loader.html","id":null,"dir":"Reference","previous_headings":"","what":"Data loader designed for the paper — data_loader","title":"Data loader designed for the paper — data_loader","text":"Even remove_unassigned_cells FALSE, cells posterior lineage 0.5 reason cells lineage calculations, posterior lineage 0.5 large compared second-highest-posterior lineage.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/data_loader.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Data loader designed for the paper — data_loader","text":"","code":"data_loader(   which_files = c(\"rna\", \"atac\", \"lineage\"),   folder_path = \"~/nzhanglab/project/Multiome_fate/out/kevin/Writeup10a/\",   file_atac = \"Writeup10a_data_atac.RData\",   file_chromvar = c(day0 = \"Writeup10a_data_chromVar_day0.RData\", day10_CIS =     \"Writeup10a_data_chromVar_day10_CIS.RData\", day10_COCL2 =     \"Writeup10a_data_chromVar_day10_COCL2.RData\", day10_DABTRAM =     \"Writeup10a_data_chromVar_day10_DABTRAM.RData\", week5_CIS =     \"Writeup10a_data_chromVar_week5_CIS.RData\", week5_COCL2 =     \"Writeup10a_data_chromVar_week5_COCL2.RData\", week5_DABTRAM =     \"Writeup10a_data_chromVar_week5_DABTRAM.RData\"),   file_empty = \"Writeup10a_data_empty.RData\",   file_fasttopics = c(CIS = \"Writeup10a_data_fasttopic_CIS.RData\", COCL2 =     \"Writeup10a_data_fasttopic_COCL2.RData\", DABTRAM =     \"Writeup10a_data_fasttopic_DABTRAM.RData\"),   file_fatepotential = \"Writeup10a_data_fatepotential.RData\",   file_lineage = \"Writeup10a_data_lineage.RData\",   file_peakvi = c(All = \"Writeup10a_data_peakVI_All.RData\", CIS =     \"Writeup10a_data_peakVI_CIS.RData\", COCL2 = \"Writeup10a_data_peakVI_COCL2.RData\",     DABTRAM = \"Writeup10a_data_peakVI_DABTRAM.RData\"),   file_rna = \"Writeup10a_data_rna.RData\",   file_rna_dimred = \"Writeup10a_data_rna_dimred.RData\",   file_saver = \"Writeup10a_data_saver.RData\",   file_saver_treatment = c(CIS = \"Writeup10a_data_saver_CIS_pca.RData\", COCL2 =     \"Writeup10a_data_saver_COCL2_pca.RData\", DABTRAM =     \"Writeup10a_data_saver_DABTRAM_pca.RData\"),   file_wnn = \"Writeup10a_data_wnn.RData\",   remove_unassigned_cells = TRUE,   verbose = 1 )"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/data_loader.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Data loader designed for the paper — data_loader","text":"which_files vector strings denoting things want load . choices among: \"atac\", \"chromvar\", \"lineage\", \"rna\", \"saver\", \"fasttopics\", \"peakvi\", \"rna_dimred\", \"wnn\". folder_path Folder preprocessed objects. change. file_atac File name ATAC counts. change. file_chromvar Vector file name chromVar analysis treatment-timepoint (7 ). change. file_empty File name base file. change. file_fasttopics Vector file name fastTopic analysis treatment arms UMAPs (3 ). change. file_fatepotential File name fate potential fits. change. file_lineage File name Lineage gRNA counts. change. file_peakvi Vector file name peakVI analysis treatment arms UMAPs (4 ). change. file_rna File name RNA counts. change. file_rna_dimred File name PCA UMAP RNA counts. change. file_saver File name SAVER analysis RNA counts. change. file_saver_treatment File name SAVER treatment-specific PCA. change. file_wnn File name WNN analysis. change. remove_unassigned_cells boolean, whether include cells assigned lineage verbose positive integer","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/data_loader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Data loader designed for the paper — data_loader","text":"Seurat object","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv.html","id":null,"dir":"Reference","previous_headings":"","what":"Lineage imputation with cross validation — lineage_cv","title":"Lineage imputation with cross validation — lineage_cv","text":"Runs K-fold CV decreasing sequence lambda values produced lineage_imputation_sequence(), selecting lambda held-objective.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lineage imputation with cross validation — lineage_cv","text":"","code":"lineage_cv(   cell_features,   cell_lineage,   future_timepoint,   lineage_future_count,   lambda_initial,   lambda_sequence_length,   tab_mat,   num_folds = 10,   savefile_tmp = NULL,   seed_number = 10,   verbose = 0 )"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lineage imputation with cross validation — lineage_cv","text":"cell_features numeric matrix row represents cell, column represents feature (instance, fastTopics scores). Let n denote number cells (rows). Please ensure row names cell_features (denoting cell IDs), column names (denoting feature names). cell_lineage character factor vector length n element cell_lineage denotes lineage cell belongs . future_timepoint character one column names tab_mat denote column denotes timepoint \"future\" time point . lineage_future_count named numeric vector (names lineage names appeared cell_lineage) denotes number cells future timepoint lineage. lambda_initial initial value lambda perform cross-validation . lambda_sequence_length number lambdas perform cross-validation . search starts lambda_initial decays exponentially 0. tab_mat matrix rows named lineage (appeared cell_lineage). two columns, one number cells current timepoint (corresponding cell_lineage). number cells future timepoint (corresponding lineage_future_count). num_folds Number folds cross-validation . Default 10. savefile_tmp Filepath save files . Default NULL (temporary save files). seed_number Seed value reproducibility reasons. Default 10. verbose numeric, numbers larger 1 successively request information printed algorithm proceeds.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lineage imputation with cross validation — lineage_cv","text":"list number elements corresponding num_folds. element list contains: test_loglik (negative log-likelihood held-lineages), train_loglik (negative log-likelihood trained lineages), train_fit (actual fit, using lineage_imputation_sequence()).","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv_finalize.html","id":null,"dir":"Reference","previous_headings":"","what":"Finalize lineage imputation after cross validation — lineage_cv_finalize","title":"Finalize lineage imputation after cross validation — lineage_cv_finalize","text":"function used running multiomeFate::lineage_cv(). Chooses lambda minimizing median held-objective across folds, refits cells chosen lambda.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv_finalize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Finalize lineage imputation after cross validation — lineage_cv_finalize","text":"","code":"lineage_cv_finalize(cell_features, cell_lineage, fit_res, lineage_future_count)"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv_finalize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Finalize lineage imputation after cross validation — lineage_cv_finalize","text":"cell_features numeric matrix row represents cell, column represents feature (instance, fastTopics scores). Let n denote number cells (rows). Please ensure row names cell_features (denoting cell IDs), column names (denoting feature names). cell_lineage character factor vector length n element cell_lineage denotes lineage cell belongs . fit_res output lineage_cv(). lineage_future_count named numeric vector (names lineage names appeared cell_lineage) denotes number cells future timepoint lineage.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_cv_finalize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Finalize lineage imputation after cross validation — lineage_cv_finalize","text":"list following elements: cell_imputed_score (vector length nrow(cell_features)) denotes predicted progenies spawning particular cell, coefficient_vec (coefficient vector lenght ncol(cell_features)+1) denotes coefficients GLM, lambda (chosen parameter cross-validation), lineage_imputed_count (vector length lineage_future_count denotes number predicted cells future timepoint lineage).","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit lineage imputation at a single lambda — lineage_imputation","title":"Fit lineage imputation at a single lambda — lineage_imputation","text":"Fit lineage imputation single lambda","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit lineage imputation at a single lambda — lineage_imputation","text":"","code":"lineage_imputation(   cell_features,   cell_lineage,   coefficient_initial_list,   lineage_future_count,   lambda = 0,   random_initializations = 10,   upper_randomness = 5,   verbose = 1 )"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit lineage imputation at a single lambda — lineage_imputation","text":"cell_features numeric matrix row represents cell, column represents feature (instance, fastTopics scores). Let n denote number cells (rows). Please ensure row names cell_features (denoting cell IDs), column names (denoting feature names). cell_lineage character factor vector length n element cell_lineage denotes lineage cell belongs . coefficient_initial_list numeric vector list numeric vectors starting coefficients (names match feature names; Intercept added missing). lineage_future_count named numeric vector (names lineage names appeared cell_lineage) denotes number cells future timepoint lineage. lambda Ridge penalty weight non-intercept coefficients. random_initializations Number additional random starts. upper_randomness Upper cap random initial coefficients. verbose numeric, numbers larger 1 successively request information printed algorithm proceeds.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit lineage imputation at a single lambda — lineage_imputation","text":"object class \"lineage_imputation\" fit res_list.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation_sequence.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit lineage imputation along a lambda path — lineage_imputation_sequence","title":"Fit lineage imputation along a lambda path — lineage_imputation_sequence","text":"function calls lineage_imputation() sequence lambdas.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation_sequence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit lineage imputation along a lambda path — lineage_imputation_sequence","text":"","code":"lineage_imputation_sequence(   cell_features,   cell_lineage,   lineage_future_count,   lambda_initial = NA,   lambda_max = 101,   lambda_min = 101,   lambda_sequence_length = 50,   multipler = 10000,   verbose = 1 )"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation_sequence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit lineage imputation along a lambda path — lineage_imputation_sequence","text":"cell_features numeric matrix row represents cell, column represents feature (instance, fastTopics scores). Let n denote number cells (rows). Please ensure row names cell_features (denoting cell IDs), column names (denoting feature names). cell_lineage character factor vector length n element cell_lineage denotes lineage cell belongs . lineage_future_count named numeric vector (names lineage names appeared cell_lineage) denotes number cells future timepoint lineage. lambda_initial initial value lambda perform cross-validation . lambda_max, lambda_min Bounds used computing internal lambda_initial. lambda_sequence_length number lambdas perform cross-validation . search starts lambda_initial decays exponentially 0. multipler Scaling factor internal lambda_initial heuristic. verbose numeric, numbers larger 1 successively request information printed algorithm proceeds.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/lineage_imputation_sequence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit lineage imputation along a lambda path — lineage_imputation_sequence","text":"list fit_list (solution estimated lineage_imputation() per lambda) lambda_sequence.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/plastic_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Plastic simulation dataset — plastic_simulation","title":"Plastic simulation dataset — plastic_simulation","text":"small, fully synthetic dataset used demonstrate test lineage-fate imputation **plastic** setting, lineage roughly median growth potential, certain lineages cells extremely high growth potential (fate propensity). Downstream lineage sizes scale \\(\\exp(\\alpha + X\\beta)\\). dataset reduced **15 lineages** fast example.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/plastic_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plastic simulation dataset — plastic_simulation","text":"","code":"data(plastic_simulation)"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/plastic_simulation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Plastic simulation dataset — plastic_simulation","text":"named list four elements: cell_features Numeric matrix size \\(n \\times p\\).     Rows cells (rownames formatted \"cell:1\", \"cell:2\", ...).     Columns preprocessed expression-derived features (intercept column;     modeling functions add internally). missing values. cell_lineage Character vector length \\(n\\) giving cell's     lineage label used training/evaluation. lineage_future_count Named numeric vector (length = 15). Names     lineage IDs matching unique(cell_lineage). value integer     equal rounded sum per-cell expected progenies     (.e., \\(\\sum_{\\\\ell} \\exp(\\alpha + x_i^\\top \\beta)\\)). tab_mat Integer matrix 15 rows 2 columns c(\"now\",\"future\");     rownames lineage IDs. Column \"now\" number current     cells observed lineage (subset); column \"future\"     equals lineage_future_count.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/plastic_simulation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plastic simulation dataset — plastic_simulation","text":"Plastic simulation dataset (15 lineages) dataset generated (summary). Loaded example embeddings via multiomeFate:::data_loader(\"fasttopics\");   used \"fasttopic.COCL2\" cell embeddings early-timepoint RNA   feature space preprocessed internal helper   .preprocess_rna(…, \"day10_COCL2\"). Estimated plastic direction intercept using internal helpers:   .generate_simulation_plastic() returned coefficient_vec   coefficient_intercept. function also assigns cells lineages.   per-cell fate potential \\(\\log_{10} \\exp(\\alpha + x^\\top \\beta)\\).   Cells probabilistically assigned lineages via internal functions   .compute_plastic_probabilities() .assign_plastic_lineages(). packaging, lineages ranked future size; 15 lineages   retained taking equally spaced ranks along ordering. Cells   belonging retained lineages dropped. Cell rownames reset   \"cell:1..n\" clarity. four objects plastic_simulation   assembled saved usethis::use_data():  Intended use. Quick-start examples lineage_cv,     lineage_cv_finalize, lineage_imputation_sequence. Unit tests small structured dataset helpful. Notes. intercept column present cell_features; modeling         functions add automatically required. data fully synthetic derived internal simulation helpers;         real subject-level outcomes included.","code":"plastic_simulation <- list(     cell_features = embedding_mat_subset,     cell_lineage = as.character(lineage_assignment_subset),     lineage_future_count = lineage_future_size_subset,     tab_mat = cbind(now = table(lineage_assignment_subset)[names(lineage_future_size_subset)],                     future = lineage_future_size_subset)   )"},{"path":[]},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/plastic_simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plastic simulation dataset — plastic_simulation","text":"","code":"data(plastic_simulation) str(plastic_simulation) #> List of 4 #>  $ cell_features       : num [1:2384, 1:30] 1.016 1.057 1.702 -0.177 -0.66 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:2384] \"cell:1\" \"cell:2\" \"cell:3\" \"cell:4\" ... #>   .. ..$ : chr [1:30] \"fastTopicCOCL2_1\" \"fastTopicCOCL2_2\" \"fastTopicCOCL2_3\" \"fastTopicCOCL2_4\" ... #>  $ cell_lineage        : chr [1:2384] \"lineage:40\" \"lineage:41\" \"lineage:42\" \"lineage:25\" ... #>  $ lineage_future_count: Named num [1:15] 532 191 156 128 119 99 95 90 87 77 ... #>   ..- attr(*, \"names\")= chr [1:15] \"lineage:16\" \"lineage:14\" \"lineage:3\" \"lineage:5\" ... #>  $ tab_mat             : num [1:15, 1:2] 159 159 159 159 159 159 159 159 159 159 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:15] \"lineage:16\" \"lineage:14\" \"lineage:3\" \"lineage:5\" ... #>   .. ..$ : chr [1:2] \"now\" \"future\"  # \\donttest{ # Minimal end-to-end example: with(plastic_simulation, {   set.seed(10)   cv <- lineage_cv(     cell_features = cell_features,     cell_lineage  = cell_lineage,     future_timepoint = \"future\",     lineage_future_count = lineage_future_count,     lambda_initial = NA,     lambda_sequence_length = 20,     tab_mat = tab_mat,     num_folds = 5,     verbose = 1   )   fit <- lineage_cv_finalize(     cell_features = cell_features,     cell_lineage  = cell_lineage,     fit_res = cv,     lineage_future_count = lineage_future_count   )    fit$lambda   head(fit$cell_imputed_score)   head(fit$lineage_imputed_count) }) #> [1] \"Dropping fold #1 out of 5\" #> [1] \"Dropping fold #2 out of 5\" #> [1] \"Dropping fold #3 out of 5\" #> [1] \"Dropping fold #4 out of 5\" #> [1] \"Dropping fold #5 out of 5\" #> lineage:13 lineage:14 lineage:16 lineage:17 lineage:18  lineage:2  #>  131.50902  188.91038  527.36352   88.56875  101.21394   77.38776  # }"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/priming_simulation.html","id":null,"dir":"Reference","previous_headings":"","what":"Priming simulation dataset — priming_simulation","title":"Priming simulation dataset — priming_simulation","text":"small, fully synthetic dataset used demonstrate test lineage-fate imputation **priming** setting, cells early time point possess heterogeneous growth potential (fate propensity) downstream lineage sizes scale \\(\\exp(\\alpha + X\\beta)\\). dataset reduced **15 lineages** fast example.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/priming_simulation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Priming simulation dataset — priming_simulation","text":"","code":"data(priming_simulation)"},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/priming_simulation.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Priming simulation dataset — priming_simulation","text":"named list four elements: cell_features Numeric matrix size \\(n \\times p\\).     Rows cells (rownames formatted \"cell:1\", \"cell:2\", ...).     Columns preprocessed expression-derived features (intercept column;     modeling functions add internally). missing values. cell_lineage Character vector length \\(n\\) giving cell's     lineage label used training/evaluation. lineage_future_count Named numeric vector (length = 15). Names     lineage IDs matching unique(cell_lineage). value integer     equal rounded sum per-cell expected progenies     (.e., \\(\\sum_{\\\\ell} \\exp(\\alpha + x_i^\\top \\beta)\\)). tab_mat Integer matrix 15 rows 2 columns c(\"now\",\"future\");     rownames lineage IDs. Column \"now\" number current     cells observed lineage (subset); column \"future\"     equals lineage_future_count.","code":""},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/priming_simulation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Priming simulation dataset — priming_simulation","text":"Priming simulation dataset (15 lineages) dataset generated (summary). Loaded example embeddings via multiomeFate:::data_loader(\"fasttopics\");   used \"fasttopic.COCL2\" cell embeddings early-timepoint RNA   feature space preprocessed internal helper   .preprocess_rna(…, \"day10_COCL2\"). Estimated priming direction intercept using internal helpers:   .search_for_priming_parameters() returned coefficient_vec   coefficient_intercept. intercept decreased small steps   expected total number descendants across cells matched   target size (chosen later timepoint, e.g. \"week5_COCL2\"), using   .compute_mean_total_cells(). Assigned cells lineages .assign_lineages_priming(),   simulating exponential clonal expansion multiple rounds. per-cell   fate potential \\(\\log_{10} \\exp(\\alpha + x^\\top \\beta)\\).   Cells grouped lineages quantiles log10 potential;   lineage future sizes rounded sums \\(\\exp(\\alpha + x^\\top \\beta)\\)   within lineage. packaging, lineages ranked future size; 15 lineages   retained taking equally spaced ranks along ordering. Cells   belonging retained lineages dropped. Cell rownames reset   \"cell:1..n\" clarity. four objects priming_simulation   assembled saved usethis::use_data():  Intended use. Quick-start examples lineage_cv,     lineage_cv_finalize, lineage_imputation_sequence. Unit tests small structured dataset helpful. Notes. intercept column present cell_features; modeling         functions add automatically required. data fully synthetic derived internal simulation helpers;         real subject-level outcomes included.","code":"priming_simulation <- list(     cell_features = embedding_mat_subset,     cell_lineage = as.character(lineage_assignment_subset),     lineage_future_count = lineage_future_size_subset,     tab_mat = cbind(now = table(lineage_assignment_subset)[names(lineage_future_size_subset)],                     future = lineage_future_size_subset)   )"},{"path":[]},{"path":"https://nancyrzhanglab.github.io/multiomeFate/reference/priming_simulation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Priming simulation dataset — priming_simulation","text":"","code":"data(priming_simulation) str(priming_simulation) #> List of 4 #>  $ cell_features       : num [1:2282, 1:30] -0.818 1.016 1.057 1.702 -0.177 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:2282] \"cell:1\" \"cell:2\" \"cell:3\" \"cell:4\" ... #>   .. ..$ : chr [1:30] \"fastTopicCOCL2_1\" \"fastTopicCOCL2_2\" \"fastTopicCOCL2_3\" \"fastTopicCOCL2_4\" ... #>  $ cell_lineage        : chr [1:2282] \"lineage:33\" \"lineage:1\" \"lineage:15\" \"lineage:15\" ... #>  $ lineage_future_count: Named num [1:15] 342 178 169 144 136 126 118 107 95 90 ... #>   ..- attr(*, \"names\")= chr [1:15] \"lineage:1\" \"lineage:4\" \"lineage:7\" \"lineage:15\" ... #>  $ tab_mat             : num [1:15, 1:2] 221 154 162 169 149 144 159 184 173 147 ... #>   ..- attr(*, \"dimnames\")=List of 2 #>   .. ..$ : chr [1:15] \"lineage:1\" \"lineage:4\" \"lineage:7\" \"lineage:15\" ... #>   .. ..$ : chr [1:2] \"now\" \"future\"  # \\donttest{ # Minimal end-to-end example: with(priming_simulation, {   set.seed(10)   cv <- lineage_cv(     cell_features = cell_features,     cell_lineage  = cell_lineage,     future_timepoint = \"future\",     lineage_future_count = lineage_future_count,     lambda_initial = NA,     lambda_sequence_length = 20,     tab_mat = tab_mat,     num_folds = 5,     verbose = 1   )   fit <- lineage_cv_finalize(     cell_features = cell_features,     cell_lineage  = cell_lineage,     fit_res = cv,     lineage_future_count = lineage_future_count   )    fit$lambda   head(fit$cell_imputed_score)   head(fit$lineage_imputed_count) }) #> [1] \"Dropping fold #1 out of 5\" #> [1] \"Dropping fold #2 out of 5\" #> [1] \"Dropping fold #3 out of 5\" #> [1] \"Dropping fold #4 out of 5\" #> [1] \"Dropping fold #5 out of 5\" #>  lineage:1 lineage:12 lineage:14 lineage:15 lineage:21 lineage:29  #>  341.63669  136.87999  126.57522  143.76615  119.16308   89.64563  # }"}]
